<!DOCTYPE html>
<html lang="zh-CN">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=no">
    <meta name="apple-mobile-web-app-capable" content="yes">
    <title>ViewStage</title>
    <link rel="stylesheet" href="styles.css">
    <script src="JS/pdf.min.js"></script>  <!-- PDF 渲染库 -->
    <script type="module" src="main.js"></script>  <!-- 主要业务逻辑 -->
</head>
<body>
    <div class="container">
        <!-- 主内容区域 -->
        <div class="main-function">
            <!-- 画布容器 -->
            <div class="canvas-container" id="canvasContainer">
                <!-- 三层Canvas架构：
                     - bgCanvas (底层): 灰色背景
                     - imageCanvas (中间层): 摄像头/PDF图像
                     - drawCanvas (顶层): 批注和橡皮擦
                 -->
                <canvas id="bgCanvas" class="canvas-base"></canvas>
                <canvas id="imageCanvas" class="canvas-image"></canvas>
                <canvas id="drawCanvas" class="canvas-draw"></canvas>
                <!-- 橡皮提示框 -->
                <div class="eraser-hint" id="eraserHint"></div>
            </div>
            
            <!-- 笔触控制面板 -->
            <div class="pen-control-panel" id="penControlPanel">
                <div class="pen-size-vertical">
                    <div class="slider-wrapper" id="penSizeSliderWrapper">
                        <svg class="triangle-track" viewBox="0 0 40 50" preserveAspectRatio="none">
                            <path d="M 12 0 L 28 0 L 20 50 Z" fill="rgba(255, 255, 255, 0.15)" stroke="rgba(255, 255, 255, 0.2)" stroke-width="1" stroke-linejoin="round" stroke-linecap="round"/>
                        </svg>
                        <div class="custom-thumb" id="penSizeThumb"></div>
                    </div>
                    <span class="pen-size-label" id="penSizeValue">2px</span>
                </div>
                <div class="pen-color-buttons" id="penColorButtons">
                    <button class="pen-color-btn" data-index="0" title="颜色1"></button>
                    <button class="pen-color-btn" data-index="1" title="颜色2"></button>
                    <button class="pen-color-btn" data-index="2" title="颜色3"></button>
                    <button class="pen-color-btn" data-index="3" title="颜色4"></button>
                    <button class="pen-color-btn" data-index="4" title="颜色5"></button>
                    <button class="pen-color-btn" data-index="5" title="颜色6"></button>
                    <button class="pen-color-btn" data-index="6" title="颜色7"></button>
                    <button class="pen-color-btn" data-index="7" title="颜色8"></button>
                    <button class="pen-color-btn" data-index="8" title="颜色9"></button>
                    <button class="pen-color-btn" data-index="9" title="颜色10"></button>
                    <button class="pen-color-btn" data-index="10" title="颜色11"></button>
                    <button class="pen-color-btn" data-index="11" title="颜色12"></button>
                    <button class="pen-color-btn" data-index="12" title="颜色13"></button>
                    <button class="pen-color-btn" data-index="13" title="颜色14"></button>
                    <button class="pen-color-btn" data-index="14" title="颜色15"></button>
                </div>
                <div class="pen-size-vertical">
                    <div class="slider-wrapper" id="eraserSizeSliderWrapper">
                        <svg class="triangle-track" viewBox="0 0 40 50" preserveAspectRatio="none">
                            <path d="M 12 0 L 28 0 L 20 50 Z" fill="rgba(255, 255, 255, 0.15)" stroke="rgba(255, 255, 255, 0.2)" stroke-width="1" stroke-linejoin="round" stroke-linecap="round"/>
                        </svg>
                        <div class="custom-thumb" id="eraserSizeThumb"></div>
                    </div>
                    <span class="pen-size-label" id="eraserSizeValue">15px</span>
                </div>
            </div>
            
            <!-- 设置面板 -->
            <div class="settings-panel" id="settingsPanel">
                <div class="settings-row">
                    <span class="settings-label">旋转：</span>
                    <button class="settings-btn" id="btnRotateLeft" title="向左旋转">
                        ↺
                    </button>
                    <button class="settings-btn" id="btnRotateRight" title="向右旋转">
                        ↻
                    </button>
                </div>
            </div>
            
            <!-- 底部工具栏 -->
            <div class="toolbar">
                <!-- 左侧：窗口控制 -->
                <div class="toolbar-left">
                    <button class="toolbar-btn" id="btnMenu">
                        <img src="assets/icon/justify.svg" width="16" height="16" alt="菜单" style="filter: invert(1);">
                        菜单
                    </button>
                    <div class="toolbar-separator"></div>
                    <button class="toolbar-btn" id="btnMinimize">
                        <img src="assets/icon/box-arrow-in-down-left.svg" width="16" height="16" alt="最小化" style="filter: invert(1);">
                        最小化
                    </button>
                </div>
                
                <!-- 中间：核心功能 -->
                <div class="toolbar-center">
                    <!-- 模式切换 -->
                    <button class="toolbar-btn function-btn" id="btnMove" data-mode="move">
                        <img src="assets/icon/move.svg" width="16" height="16" alt="移动" style="filter: invert(1);">
                        移动
                    </button>
                    <div class="toolbar-separator"></div>
                    <button class="toolbar-btn function-btn" id="btnComment" data-mode="comment">
                        <img src="assets/icon/pen.svg" width="16" height="16" alt="批注" style="filter: invert(1);">
                        批注
                    </button>
                    <div class="toolbar-separator"></div>
                    <button class="toolbar-btn function-btn" id="btnEraser" data-mode="eraser">
                        <img src="assets/icon/eraser.svg" width="16" height="16" alt="橡皮" style="filter: invert(1);">
                        橡皮
                    </button>
                    
                    <!-- 批注工具 -->
                    <div class="toolbar-separator"></div>
                    <button class="toolbar-btn function-btn" id="btnUndo">
                        <img src="assets/icon/reply.svg" width="16" height="16" alt="撤销" style="filter: invert(1);">
                        撤销
                    </button>
                    <div class="toolbar-separator"></div>
                    <button class="toolbar-btn function-btn" id="btnClear">
                        <img src="assets/icon/file-earmark-break.svg" width="16" height="16" alt="清空批注" style="filter: invert(1);">
                        清空批注
                    </button>
                    
                    <div class="toolbar-separator-bold"></div>
                    
                    <!-- 摄像头功能 -->
                    <button class="toolbar-btn function-btn" id="btnPhoto">
                        <img src="assets/icon/camera.svg" width="16" height="16" alt="拍照" style="filter: invert(1);">
                        拍照
                    </button>
                    
                    <div class="toolbar-separator enhance-separator"></div>
                    
                    <!-- 图像处理 -->
                    <button class="toolbar-btn function-btn enhance-btn" id="btnEnhance">
                        <img src="assets/icon/file-earmark-medical.svg" width="16" height="16" alt="文档增强" style="filter: invert(1);">
                        文档增强
                    </button>
                    
                    <div class="toolbar-separator enhance-separator"></div>
                    
                    <!-- 设置 -->
                    <button class="toolbar-btn function-btn" id="btnSettings">
                        <img src="assets/icon/gear.svg" width="16" height="16" alt="设置" style="filter: invert(1);">
                        设置
                    </button>
                </div>
                
                <!-- 右侧：侧边栏控制 -->
                <div class="toolbar-right">
                    <button class="toolbar-btn" id="btnExpand">
                        <img src="assets/icon/file-earmark-medical.svg" width="16" height="16" alt="图片" style="filter: invert(1);">
                        图片
                    </button>
                    <div class="toolbar-separator"></div>
                    <button class="toolbar-btn" id="btnSave">
                        <img src="assets/icon/File.svg" width="16" height="16" alt="文件" style="filter: invert(1);">
                        文件
                    </button>
                </div>
            </div>
        </div>
    </div>
    
</body>
</html>